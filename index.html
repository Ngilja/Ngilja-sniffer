<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Mon Site Extraordinaire d'Anniversaire</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; background-color: #f4f4f4; }
        .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); max-width: 500px; margin: 0 auto; }
        textarea { width: 90%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; margin-bottom: 20px; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        #confirmation { margin-top: 20px; font-weight: bold; color: green; }
    </style>
</head>
<body>
    <div class="container">
        <h1>✨ Laissez-moi un message Extraordinaire ! ✨</h1>
        
        <form id="messageForm">
            <textarea id="messageInput" name="message" rows="6" placeholder="Écrivez votre message ici... Joyeux anniversaire, félicitations, ou tout autre mot gentil !"></textarea><br>
            
            <button type="submit">Envoyer le Message Secret</button>
        </form>

        <p id="confirmation"></p>
    </div>
    
    <script>
        document.getElementById('messageForm').addEventListener('submit', function(e) {
            e.preventDefault(); 

            const message = document.getElementById('messageInput').value;
            const confirmation = document.getElementById('confirmation');
            
            // On vérifie si le message est vide
            if (message.trim() === "") {
                confirmation.innerText = "Veuillez écrire un message s'il vous plaît.";
                confirmation.style.color = "red";
                return;
            }

            confirmation.innerText = "Envoi du message en cours...";
            confirmation.style.color = "orange";
            
            // --- C'est la partie clé pour communiquer avec le serveur Back-End (Flask) ---
            fetch('/send_message', { 
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ message: message })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === "success") {
                    confirmation.innerText = "✅ Message extraordinaire envoyé ! Merci beaucoup !";
                    confirmation.style.color = "green";
                    document.getElementById('messageInput').value = ''; // Efface le champ
                } else {
                    confirmation.innerText = "❌ Erreur lors de l'envoi du message : " + data.message;
                    confirmation.style.color = "red";
                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                confirmation.innerText = "❌ Une erreur technique s'est produite. Désolé !";
                confirmation.style.color = "red";
            });
        });
    </script>
</body>
</html>
